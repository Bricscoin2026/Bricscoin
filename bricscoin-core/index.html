<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BricsCoin Core</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 100%);
      color: #fff;
      min-height: 100vh;
    }
    .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
    
    /* Header */
    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 20px;
      border-bottom: 1px solid rgba(255,215,0,0.2);
      margin-bottom: 30px;
    }
    .logo { display: flex; align-items: center; gap: 15px; }
    .logo h1 { color: #ffd700; font-size: 24px; }
    .logo span { color: #888; font-size: 12px; }
    .status { display: flex; align-items: center; gap: 8px; }
    .status-dot { width: 10px; height: 10px; border-radius: 50%; }
    .status-dot.connected { background: #00ff00; box-shadow: 0 0 10px #00ff00; }
    .status-dot.disconnected { background: #ff0000; }
    
    /* Tabs */
    .tabs { display: flex; gap: 10px; margin-bottom: 30px; }
    .tab {
      padding: 12px 24px;
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 8px;
      color: #888;
      cursor: pointer;
      transition: all 0.3s;
    }
    .tab:hover { background: rgba(255,255,255,0.1); }
    .tab.active { background: rgba(255,215,0,0.2); color: #ffd700; border-color: #ffd700; }
    
    /* Cards */
    .card {
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 20px;
    }
    .card h2 { color: #ffd700; margin-bottom: 20px; font-size: 18px; }
    
    /* Stats Grid */
    .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px; }
    .stat-card {
      background: rgba(255,215,0,0.1);
      border: 1px solid rgba(255,215,0,0.2);
      border-radius: 12px;
      padding: 20px;
      text-align: center;
    }
    .stat-card .value { font-size: 28px; font-weight: bold; color: #ffd700; }
    .stat-card .label { color: #888; font-size: 14px; margin-top: 5px; }
    
    /* Forms */
    input, select {
      width: 100%;
      padding: 12px 16px;
      background: rgba(0,0,0,0.3);
      border: 1px solid rgba(255,255,255,0.2);
      border-radius: 8px;
      color: #fff;
      font-size: 14px;
      margin-bottom: 15px;
    }
    input:focus { outline: none; border-color: #ffd700; }
    
    button {
      padding: 12px 24px;
      background: linear-gradient(135deg, #ffd700 0%, #ff8c00 100%);
      border: none;
      border-radius: 8px;
      color: #000;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s;
    }
    button:hover { transform: translateY(-2px); box-shadow: 0 5px 20px rgba(255,215,0,0.3); }
    button:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }
    button.secondary { background: rgba(255,255,255,0.1); color: #fff; }
    button.danger { background: #ff4444; }
    
    /* Wallet */
    .wallet-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px;
      background: rgba(0,0,0,0.2);
      border-radius: 8px;
      margin-bottom: 10px;
    }
    .wallet-item .address { font-family: monospace; font-size: 14px; color: #ffd700; }
    .wallet-item .balance { font-size: 18px; font-weight: bold; }
    
    /* Mining */
    .mining-stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin: 20px 0; }
    .mining-stat { text-align: center; }
    .mining-stat .value { font-size: 24px; color: #ffd700; font-family: monospace; }
    .mining-stat .label { font-size: 12px; color: #888; }
    
    /* Blocks Table */
    table { width: 100%; border-collapse: collapse; }
    th, td { padding: 12px; text-align: left; border-bottom: 1px solid rgba(255,255,255,0.1); }
    th { color: #888; font-size: 12px; text-transform: uppercase; }
    td { font-family: monospace; font-size: 13px; }
    
    /* Toast */
    .toast {
      position: fixed;
      bottom: 20px;
      right: 20px;
      padding: 15px 25px;
      background: #ffd700;
      color: #000;
      border-radius: 8px;
      font-weight: bold;
      animation: slideIn 0.3s ease;
    }
    @keyframes slideIn { from { transform: translateX(100%); } to { transform: translateX(0); } }
    
    /* Hidden sections */
    .section { display: none; }
    .section.active { display: block; }
    
    /* Seed phrase display */
    .seed-phrase {
      background: rgba(255,0,0,0.1);
      border: 1px solid rgba(255,0,0,0.3);
      padding: 15px;
      border-radius: 8px;
      font-family: monospace;
      margin: 15px 0;
      word-break: break-all;
    }
    .warning { color: #ff6b6b; font-size: 12px; margin-top: 10px; }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="logo">
        <h1>BRICSCOIN CORE</h1>
        <span>v1.0.0</span>
      </div>
      <div class="status">
        <div class="status-dot" id="status-dot"></div>
        <span id="status-text">Connecting...</span>
      </div>
    </header>
    
    <div class="tabs">
      <div class="tab active" data-tab="dashboard">Dashboard</div>
      <div class="tab" data-tab="wallet">Wallet</div>
      <div class="tab" data-tab="mining">Mining</div>
      <div class="tab" data-tab="blocks">Blocks</div>
    </div>
    
    <!-- Dashboard -->
    <div id="dashboard" class="section active">
      <div class="stats-grid">
        <div class="stat-card">
          <div class="value" id="stat-supply">-</div>
          <div class="label">Circulating Supply</div>
        </div>
        <div class="stat-card">
          <div class="value" id="stat-blocks">-</div>
          <div class="label">Total Blocks</div>
        </div>
        <div class="stat-card">
          <div class="value" id="stat-difficulty">-</div>
          <div class="label">Difficulty</div>
        </div>
        <div class="stat-card">
          <div class="value" id="stat-reward">50</div>
          <div class="label">Block Reward</div>
        </div>
      </div>
      
      <div class="card">
        <h2>Recent Blocks</h2>
        <table>
          <thead>
            <tr><th>Height</th><th>Hash</th><th>Miner</th><th>Time</th></tr>
          </thead>
          <tbody id="recent-blocks"></tbody>
        </table>
      </div>
    </div>
    
    <!-- Wallet -->
    <div id="wallet" class="section">
      <div class="card">
        <h2>Your Wallets</h2>
        <div id="wallets-list"></div>
        <button onclick="createWallet()" style="margin-top: 15px;">+ Create New Wallet</button>
      </div>
      
      <div class="card">
        <h2>Send BRICS</h2>
        <select id="send-from"></select>
        <input type="text" id="send-to" placeholder="Recipient Address (BRICS...)">
        <input type="number" id="send-amount" placeholder="Amount">
        <button onclick="sendTransaction()">Send</button>
      </div>
    </div>
    
    <!-- Mining -->
    <div id="mining" class="section">
      <div class="card">
        <h2>Mining</h2>
        <select id="mining-wallet"></select>
        <div class="mining-stats">
          <div class="mining-stat">
            <div class="value" id="mining-hashrate">0</div>
            <div class="label">H/s</div>
          </div>
          <div class="mining-stat">
            <div class="value" id="mining-nonce">0</div>
            <div class="label">Nonce</div>
          </div>
          <div class="mining-stat">
            <div class="value" id="mining-blocks">0</div>
            <div class="label">Blocks Found</div>
          </div>
        </div>
        <p id="mining-status" style="color: #888; margin-bottom: 15px;">Click Start to begin mining</p>
        <button id="mining-btn" onclick="toggleMining()">Start Mining</button>
      </div>
    </div>
    
    <!-- Blocks -->
    <div id="blocks" class="section">
      <div class="card">
        <h2>All Blocks</h2>
        <table>
          <thead>
            <tr><th>Height</th><th>Hash</th><th>Miner</th><th>Txs</th><th>Time</th></tr>
          </thead>
          <tbody id="all-blocks"></tbody>
        </table>
      </div>
    </div>
  </div>
  
  <div id="toast" class="toast" style="display: none;"></div>
  
  <script>
    let isMining = false;
    let blocksFound = 0;
    
    // Tab switching
    document.querySelectorAll('.tab').forEach(tab => {
      tab.addEventListener('click', () => {
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
        tab.classList.add('active');
        document.getElementById(tab.dataset.tab).classList.add('active');
      });
    });
    
    // Toast notification
    function showToast(message) {
      const toast = document.getElementById('toast');
      toast.textContent = message;
      toast.style.display = 'block';
      setTimeout(() => toast.style.display = 'none', 3000);
    }
    
    // Load network stats
    async function loadStats() {
      try {
        const stats = await window.bricscoin.getNetworkStats();
        if (stats) {
          document.getElementById('stat-supply').textContent = stats.circulating_supply?.toLocaleString() || '-';
          document.getElementById('stat-blocks').textContent = stats.total_blocks || '-';
          document.getElementById('stat-difficulty').textContent = stats.current_difficulty || '-';
          document.getElementById('stat-reward').textContent = stats.current_reward || '50';
          
          document.getElementById('status-dot').classList.add('connected');
          document.getElementById('status-text').textContent = 'Connected to bricscoin26.org';
        }
      } catch (e) {
        document.getElementById('status-dot').classList.remove('connected');
        document.getElementById('status-text').textContent = 'Disconnected';
      }
    }
    
    // Load recent blocks
    async function loadBlocks() {
      try {
        const blocks = await window.bricscoin.getBlocks(10);
        const tbody = document.getElementById('recent-blocks');
        const allTbody = document.getElementById('all-blocks');
        
        tbody.innerHTML = '';
        allTbody.innerHTML = '';
        
        blocks.forEach(block => {
          const row = `<tr>
            <td>#${block.index}</td>
            <td>${block.hash?.substring(0, 16)}...</td>
            <td>${block.miner?.substring(0, 12)}...</td>
            <td>${new Date(block.timestamp).toLocaleString()}</td>
          </tr>`;
          tbody.innerHTML += row;
          
          const fullRow = `<tr>
            <td>#${block.index}</td>
            <td>${block.hash?.substring(0, 20)}...</td>
            <td>${block.miner?.substring(0, 15)}...</td>
            <td>${block.transactions?.length || 0}</td>
            <td>${new Date(block.timestamp).toLocaleString()}</td>
          </tr>`;
          allTbody.innerHTML += fullRow;
        });
      } catch (e) {
        console.error('Error loading blocks:', e);
      }
    }
    
    // Load wallets
    async function loadWallets() {
      try {
        const wallets = await window.bricscoin.getWallets();
        const list = document.getElementById('wallets-list');
        const sendFrom = document.getElementById('send-from');
        const miningWallet = document.getElementById('mining-wallet');
        
        list.innerHTML = '';
        sendFrom.innerHTML = '<option value="">Select wallet</option>';
        miningWallet.innerHTML = '<option value="">Select wallet for mining</option>';
        
        if (wallets.length === 0) {
          list.innerHTML = '<p style="color: #888;">No wallets yet. Create one to get started.</p>';
          return;
        }
        
        wallets.forEach(wallet => {
          list.innerHTML += `
            <div class="wallet-item">
              <div>
                <div style="font-weight: bold; margin-bottom: 5px;">${wallet.name}</div>
                <div class="address">${wallet.address}</div>
                <div class="seed-phrase" style="margin-top: 10px; font-size: 11px;">
                  <strong>Seed Phrase:</strong> ${wallet.seedPhrase}
                </div>
                <p class="warning">⚠️ Save this seed phrase! It's the only way to recover your wallet.</p>
              </div>
              <div class="balance">${wallet.balance || 0} BRICS</div>
            </div>
          `;
          
          sendFrom.innerHTML += `<option value="${wallet.address}">${wallet.name} (${wallet.balance || 0} BRICS)</option>`;
          miningWallet.innerHTML += `<option value="${wallet.address}">${wallet.name}</option>`;
        });
      } catch (e) {
        console.error('Error loading wallets:', e);
      }
    }
    
    // Create wallet
    async function createWallet() {
      const name = prompt('Wallet name:') || 'My Wallet';
      try {
        const wallet = await window.bricscoin.createWallet(name);
        showToast('Wallet created!');
        loadWallets();
      } catch (e) {
        alert('Error: ' + e.message);
      }
    }
    
    // Send transaction
    async function sendTransaction() {
      const from = document.getElementById('send-from').value;
      const to = document.getElementById('send-to').value;
      const amount = parseFloat(document.getElementById('send-amount').value);
      
      if (!from || !to || !amount) {
        alert('Fill all fields');
        return;
      }
      
      try {
        await window.bricscoin.sendTransaction(from, to, amount);
        showToast('Transaction sent!');
        document.getElementById('send-to').value = '';
        document.getElementById('send-amount').value = '';
        loadWallets();
      } catch (e) {
        alert('Error: ' + e.message);
      }
    }
    
    // Mining
    async function toggleMining() {
      const btn = document.getElementById('mining-btn');
      const wallet = document.getElementById('mining-wallet').value;
      
      if (!isMining) {
        if (!wallet) {
          alert('Select a wallet first');
          return;
        }
        
        await window.bricscoin.startMining(wallet);
        btn.textContent = 'Stop Mining';
        btn.classList.add('danger');
        isMining = true;
      } else {
        await window.bricscoin.stopMining();
        btn.textContent = 'Start Mining';
        btn.classList.remove('danger');
        isMining = false;
      }
    }
    
    // Mining events
    window.bricscoin.onMiningStatus((data) => {
      document.getElementById('mining-status').textContent = `Status: ${data.status}` + 
        (data.block ? ` | Mining block #${data.block}` : '');
    });
    
    window.bricscoin.onMiningProgress((data) => {
      document.getElementById('mining-hashrate').textContent = data.hashrate?.toLocaleString() || 0;
      document.getElementById('mining-nonce').textContent = data.nonce?.toLocaleString() || 0;
    });
    
    window.bricscoin.onBlockFound((data) => {
      blocksFound++;
      document.getElementById('mining-blocks').textContent = blocksFound;
      showToast(`Block #${data.block} found! +${data.reward} BRICS`);
      loadStats();
      loadBlocks();
      loadWallets();
    });
    
    // Initialize
    loadStats();
    loadBlocks();
    loadWallets();
    
    // Auto-refresh
    setInterval(loadStats, 10000);
    setInterval(loadBlocks, 30000);
  </script>
</body>
</html>
