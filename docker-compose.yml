# BricsCoin Node - Docker Compose (aggiornato)
# Run your own BricsCoin node and join the network!

services:
  # MongoDB database
  bricscoin-db:
    image: mongo:7
    container_name: bricscoin-db
    volumes:
      - bricscoin-data:/data/db
    restart: unless-stopped

  # BricsCoin Node
  bricscoin-node:
    build: .
    container_name: bricscoin-node
    ports:
      - "8001:8001"   # Node API
      - "3333:3333"   # Stratum mining port
    environment:
      - MONGO_URL=mongodb://bricscoin-db:27017
      - DB_NAME=bricscoin
      - NODE_ID=${NODE_ID:-}
      - NODE_URL=${NODE_URL:-}
      - SEED_NODES=${SEED_NODES:-https://brics-chain.preview.emergentagent.com}
      - CORS_ORIGINS=*
    depends_on:
      - bricscoin-db
    restart: unless-stopped

  # Optional: BricsCoin Frontend (Web UI)
  bricscoin-frontend:
    image: node:20-alpine
    container_name: bricscoin-frontend
    working_dir: /app
    volumes:
      - ./frontend:/app
    ports:
      - "3000:3000"
    environment:
      - REACT_APP_BACKEND_URL=${REACT_APP_BACKEND_URL:-https://bricscoin26.org}
    command: sh -c "yarn install && yarn start"
    depends_on:
      - bricscoin-node
    profiles:
      - with-frontend

volumes:
  bricscoin-data:
