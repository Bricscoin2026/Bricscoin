# BricsCoin Node - Docker Compose
# Run your own BricsCoin node and join the network!

version: '3.8'

services:
  # MongoDB database
  mongo:
    image: mongo:7
    container_name: bricscoin-db
    volumes:
      - bricscoin-data:/data/db
    restart: unless-stopped

  # BricsCoin Node
  bricscoin-node:
    build: .
    container_name: bricscoin-node
    ports:
      - "8001:8001"
    environment:
      - MONGO_URL=mongodb://mongo:27017
      - DB_NAME=bricscoin
      # Generate a unique node ID or leave empty for auto-generation
      - NODE_ID=${NODE_ID:-}
      # Your node's public URL (required for P2P)
      - NODE_URL=${NODE_URL:-}
      # Comma-separated list of seed nodes to connect to
      - SEED_NODES=${SEED_NODES:-https://bricscoin-sha256.preview.emergentagent.com}
      - CORS_ORIGINS=*
    depends_on:
      - mongo
    restart: unless-stopped

  # Optional: BricsCoin Frontend (Web UI)
  bricscoin-frontend:
    image: node:20-alpine
    container_name: bricscoin-frontend
    working_dir: /app
    volumes:
      - ./frontend:/app
    ports:
      - "3000:3000"
    environment:
      - REACT_APP_BACKEND_URL=http://localhost:8001
    command: sh -c "yarn install && yarn start"
    depends_on:
      - bricscoin-node
    profiles:
      - with-frontend

volumes:
  bricscoin-data:
